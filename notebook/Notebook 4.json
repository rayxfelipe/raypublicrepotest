{
	"name": "Notebook 4",
	"properties": {
		"folder": {
			"name": "OR-DOT"
		},
		"nbformat": 4,
		"nbformat_minor": 2,
		"bigDataPool": {
			"referenceName": "SparkPool13",
			"type": "BigDataPoolReference"
		},
		"sessionProperties": {
			"driverMemory": "28g",
			"driverCores": 4,
			"executorMemory": "28g",
			"executorCores": 4,
			"numExecutors": 1,
			"runAsWorkspaceSystemIdentity": false,
			"conf": {
				"spark.dynamicAllocation.enabled": "true",
				"spark.dynamicAllocation.minExecutors": "1",
				"spark.dynamicAllocation.maxExecutors": "4",
				"spark.autotune.trackingId": "8b2a956b-6571-4d46-b927-4ef34803e568"
			}
		},
		"metadata": {
			"saveOutput": true,
			"synapse_widget": {
				"version": "0.1",
				"state": {
					"7c346bcb-0092-4515-a5ef-e0af416bfa08": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": {
											"devices": [
												{
													"id": "8ecb1eb9-c83e-4284-a284-984f1234bf43",
													"intersection": {
														"id": "8e7a71cd-6c0a-47f8-b72f-cea2d2f912cf",
														"name": "OR8_Adair @ 10th_W"
													},
													"ipAddress": "10.11.16.19",
													"name": "122534"
												},
												{
													"id": "fa8cece3-be54-4c44-b598-4a4068509641",
													"intersection": {
														"id": "f9410c0a-c346-4882-b78d-3d18dbdbdc30",
														"name": "Mt. Fanny"
													},
													"ipAddress": "167.131.224.28",
													"name": "50003"
												},
												{
													"id": "3fd704b6-7bd4-45d3-9a93-9048b53c7de1",
													"intersection": {
														"id": "a3d8d4fc-2132-403b-baf8-3dda35bb1ee9",
														"name": "Sacajawea Peak"
													},
													"ipAddress": "167.131.224.29",
													"name": "50004"
												},
												{
													"id": "b60b642f-5aab-4689-b98e-59c2a128ac08",
													"intersection": {
														"id": "a34a188e-2218-4769-a02f-2181cf73c4fa",
														"name": "TSSU Test cabinet"
													},
													"ipAddress": "167.131.83.146",
													"name": "8146"
												},
												{
													"id": "1132fba6-a975-4363-9fcb-7c50b1ffdcc2",
													"intersection": {
														"id": "ff98452f-4b18-4055-8699-fd5fe027f999",
														"name": "TSSU TEST CABINET 332S"
													},
													"ipAddress": "167.131.83.160",
													"name": "8160"
												},
												{
													"id": "43e90bb1-0443-43f6-91e5-36b61de94c43",
													"intersection": {
														"id": "2ecec989-76ef-4ee9-aef1-22d91c2703e7",
														"name": "Just the Tardis"
													},
													"ipAddress": "167.131.144.86",
													"name": "7"
												},
												{
													"id": "7b687d0c-a83b-4c57-b147-e2f85bfb393d",
													"intersection": {
														"id": "f10faad1-0a3e-45b0-bf46-bced60b6b266",
														"name": "US101 @ N 22nd St"
													},
													"ipAddress": "10.11.141.166",
													"name": "204013"
												},
												{
													"id": "dffdea49-ba4d-41ff-834e-9aa7ca83b4fc",
													"intersection": {
														"id": "a68a8912-6581-4882-ac17-fa3e33f63e1c",
														"name": "US101 @ N 17th St"
													},
													"ipAddress": "10.11.141.165",
													"name": "204014"
												},
												{
													"id": "cf6f547d-528d-4a6d-aa4d-8de673e00e43",
													"intersection": {
														"id": "41536d62-935f-44d7-a966-6eb74b22a3ae",
														"name": "US101 @ N 14th St"
													},
													"ipAddress": "10.11.141.164",
													"name": "204091"
												},
												{
													"id": "23a046ef-65be-43f1-bb5e-638b87d599eb",
													"intersection": {
														"id": "0ce0b368-8033-403c-a4e3-8215f0b85a8f",
														"name": "TSSU Test Cabinet #5"
													},
													"ipAddress": "167.131.83.144",
													"name": "8144"
												},
												{
													"id": "97947543-d72b-4a06-84d4-52cc1d464bff",
													"intersection": {
														"id": "c28745b4-67d2-45a4-b49e-2d5d226a31f9",
														"name": "TSSU Test Cabinet #2 "
													},
													"ipAddress": "167.131.83.142",
													"name": "8142"
												},
												{
													"id": "97fd0b1b-2601-428c-aa44-defbd948023c",
													"intersection": {
														"id": "14747a1c-702e-463a-aace-78b4ee08c4c5",
														"name": "US101 @ N 6th St"
													},
													"ipAddress": "10.11.141.163",
													"name": "204090"
												},
												{
													"id": "6b58d3f4-70d6-4440-804b-dfd52b310610",
													"intersection": {
														"id": "f914b938-707a-4ea3-a3b5-c3b2062f64c0",
														"name": "US101 @ S 1st St"
													},
													"ipAddress": "10.11.141.167",
													"name": "204009"
												},
												{
													"id": "848614d4-e35b-49ea-a062-87de3d5c6d82",
													"intersection": {
														"id": "2eeb3c59-aa03-4805-a4be-42a24c358499",
														"name": "US101 @ Ro-Mar Dev"
													},
													"ipAddress": "10.11.141.168",
													"name": "204011"
												},
												{
													"id": "2097b021-5799-4cc0-85a5-de6aa5243072",
													"intersection": {
														"id": "e951417f-6169-41c6-91e8-43fb935f7072",
														"name": "US101 @ E Devils Lake Rd"
													},
													"ipAddress": "10.11.141.169",
													"name": "204012"
												},
												{
													"id": "0f3d3797-cbe4-46ff-a2ff-130bae4af681",
													"intersection": {
														"id": "77c2a31a-a965-4a5f-a8c2-a783a9839174",
														"name": "TSSU Test Cabinet #1"
													},
													"ipAddress": "167.131.83.141",
													"name": "8141"
												},
												{
													"id": "a5535d96-6aac-424f-b7cc-2f4b9fefab8e",
													"intersection": {
														"id": "bea3ed6c-e978-4139-8b92-7fb55c3f195c",
														"name": "The Tardis"
													},
													"ipAddress": "167.131.144.86",
													"name": "3"
												},
												{
													"id": "4e1b724a-edb9-41a1-b28b-c441442d47ad",
													"intersection": {
														"id": "8daba2f6-deea-4983-8ec6-da01ac84bc14",
														"name": "Pendleton Test Controller"
													},
													"ipAddress": "167.131.241.152",
													"name": "512512"
												},
												{
													"id": "c9314f9f-b079-40a6-875a-c191ca698000",
													"intersection": {
														"id": "5086f51b-95e6-4f24-91ca-ce72b4097168",
														"name": "OR34 Bypass"
													},
													"ipAddress": "10.11.144.18",
													"name": "204035"
												},
												{
													"id": "0d4a4949-6b0d-4c5e-b54b-c70da1de7f79",
													"intersection": {
														"id": "c32fff52-44be-45c5-bb09-75d31cbaae28",
														"name": "OR34 at Peoria"
													},
													"ipAddress": "10.11.203.10",
													"name": "204034"
												},
												{
													"id": "751fc106-624f-4989-af7c-b247b6a91dc4",
													"intersection": {
														"id": "1e2a8582-01e6-4881-8846-0037f93cd1a5",
														"name": "OR214 at Evergreen"
													},
													"ipAddress": "10.11.137.69",
													"name": "203027"
												},
												{
													"id": "e7abd0bd-192a-4d1e-a52b-8259f1dd7dc5",
													"intersection": {
														"id": "3b644d1f-c08c-4f9f-86bf-99d416a8958e",
														"name": "OR214 at Oregon Way - Country Club"
													},
													"ipAddress": "10.11.137.70",
													"name": "203029"
												},
												{
													"id": "ada8aed2-d828-4bac-9860-ed83b2607639",
													"intersection": {
														"id": "43eee50a-122f-4c2b-992e-19052d7642ff",
														"name": "OR219 at Woodland Avenue"
													},
													"ipAddress": "10.11.137.66",
													"name": "203021"
												},
												{
													"id": "c47bfce6-014e-4c97-b635-7367898c6f32",
													"intersection": {
														"id": "27ab5fb3-8ca0-4213-bb61-134420854a14",
														"name": "OR214 at I5 SB Ramp"
													},
													"ipAddress": "10.11.137.70",
													"name": "203026"
												},
												{
													"id": "d85e15ee-f60b-496a-8988-28ef328fe120",
													"intersection": {
														"id": "ad6572c3-4184-47d0-8d76-1a077b24d1a0",
														"name": "OR214 at I5 NB Ramp"
													},
													"ipAddress": "10.11.137.74",
													"name": "203024"
												},
												{
													"id": "6f49fdc7-4a2f-48f6-b985-9aa25b6faf72",
													"intersection": {
														"id": "2dad5e83-0663-452b-b575-3c5b7dd41189",
														"name": "OR34 at Seven  Mile Lane"
													},
													"ipAddress": "10.11.143.146",
													"name": "204088"
												},
												{
													"id": "af51d182-7988-46a9-bdb8-9493415874ca",
													"intersection": {
														"id": "79e5f2af-a7ab-4dd0-acb1-b64d8506054e",
														"name": "Pine Drops (TEST)"
													},
													"ipAddress": "167.131.210.87",
													"name": "4001"
												},
												{
													"id": "f9c087c8-adb8-4ea4-b0c7-2596f8d08e79",
													"intersection": {
														"id": "3109a27c-4975-4ff7-8841-2b179baa4434",
														"name": "OR212_Clackamas Hwy @ 122nd_Sunrise_ExpressWay"
													},
													"ipAddress": "10.11.4.78",
													"name": "122065"
												},
												{
													"id": "4f51f270-6ebb-4bd2-9214-9a56f683fd0d",
													"intersection": {
														"id": "6ae669ba-4ce7-4efb-aab0-f8e8373934a1",
														"name": "D7 Test "
													},
													"ipAddress": "167.131.168.45",
													"name": "3001"
												},
												{
													"id": "42210c91-6229-45fc-b0d5-8384ffae5899",
													"intersection": {
														"id": "2bf76c3f-83bb-43f6-94af-f0cb0acc5b61",
														"name": "Ashland St @ Tolman Creek"
													},
													"ipAddress": "10.12.1.84",
													"name": "308059"
												},
												{
													"id": "9ddd9266-c5cf-4d9c-bac8-53a3f1bac3b9",
													"intersection": {
														"id": "f7b43906-e1cf-4638-85c7-5d8817987e41",
														"name": "SPUI"
													},
													"ipAddress": "167.131.190.156",
													"name": "308187"
												},
												{
													"id": "03b5b5eb-50a7-47a4-b220-c80b920d457d",
													"intersection": {
														"id": "8588b39e-0044-41cf-8ed8-fb863df7757d",
														"name": "3rd at Baker"
													},
													"ipAddress": "10.11.129.75",
													"name": "203069"
												},
												{
													"id": "b5b481cd-b2df-43d6-834f-92bee5098f6b",
													"intersection": {
														"id": "eece6924-bd26-4b56-a876-ac8a52b7c165",
														"name": "2nd at Baker"
													},
													"ipAddress": "10.11.129.82",
													"name": "203068"
												},
												{
													"id": "430c222b-a2a7-4936-a46d-33c9351a6a6b",
													"intersection": {
														"id": "4c9cbc52-7743-482c-92e8-ad922b2d3a39",
														"name": "2nd at Adams"
													},
													"ipAddress": "10.11.129.83",
													"name": "203066"
												},
												{
													"id": "d06847c4-39fc-4175-84d4-6c2194365fc1",
													"intersection": {
														"id": "93ab1e3b-ccbb-47ed-b038-69af4e51d5b8",
														"name": "OR99W at OR18"
													},
													"ipAddress": "10.11.148.34",
													"name": "203104"
												},
												{
													"id": "b55753f1-a1d9-4c0d-9369-1c2a78e84f4f",
													"intersection": {
														"id": "53e9ead5-00dd-43fd-b3d3-4bab2239175b",
														"name": "RPM (TEST)"
													},
													"ipAddress": "167.131.210.88",
													"name": "4002"
												},
												{
													"id": "b4d651fb-7e8c-48a0-8ab7-ef9b61feb12c",
													"intersection": {
														"id": "0c1e5821-2857-4009-b551-dd6eb72b3e11",
														"name": "Diamond Lake @ Winchester"
													},
													"ipAddress": "10.12.1.162",
													"name": "306016"
												},
												{
													"id": "82913734-7b66-4a6d-a94a-5582c955ec8a",
													"intersection": {
														"id": "d8ad3331-9205-483d-9b0a-db642d6c3b46",
														"name": "12th at Commercial"
													},
													"ipAddress": "10.11.208.73",
													"name": "201034"
												},
												{
													"id": "ecd5ab10-213a-4bbd-9b4a-90c08b4c9175",
													"intersection": {
														"id": "0144d775-3e59-4a84-aa84-d12315bc3817",
														"name": "14th at Commercial"
													},
													"ipAddress": "10.11.208.72",
													"name": "201035"
												},
												{
													"id": "5d0b1e01-0f15-414f-8706-247f1ef57b0c",
													"intersection": {
														"id": "1e669e9f-1239-4991-8653-bb739d6719e6",
														"name": "9th at Commercial"
													},
													"ipAddress": "10.11.208.69",
													"name": "201032"
												},
												{
													"id": "1d28e189-a3fe-4746-b3a7-1e4a6a2f5598",
													"intersection": {
														"id": "55219fe7-2089-44f7-83c7-5ef014416094",
														"name": "11th at Commercial"
													},
													"ipAddress": "10.11.208.70",
													"name": "201033"
												},
												{
													"id": "55252312-370a-4aef-9633-42eef29da203",
													"intersection": {
														"id": "4e58f108-7da3-44c2-b423-6587864dd54e",
														"name": "9th at Marine"
													},
													"ipAddress": "10.11.208.68",
													"name": "201038"
												},
												{
													"id": "703f33e9-a9c0-40aa-83d2-135055bcf943",
													"intersection": {
														"id": "d3153ff7-1c05-43b4-ae83-acbd7a54ceb1",
														"name": "11th at Duane"
													},
													"ipAddress": "10.11.208.71",
													"name": "201039"
												},
												{
													"id": "b9395e5b-7c5d-4c26-b5fb-bd680045f700",
													"intersection": {
														"id": "9d524105-613b-4b07-8520-f580c91610ba",
														"name": "14th at Marine"
													},
													"ipAddress": "10.11.208.66",
													"name": "201036"
												},
												{
													"id": "3d6ac57b-117a-45da-9bf4-5d87001a26ca",
													"intersection": {
														"id": "029f9095-88aa-4e85-8ca4-14ace69dec27",
														"name": "11th at Marine"
													},
													"ipAddress": "10.11.208.67",
													"name": "201037"
												},
												{
													"id": "63ed0df2-474f-4d1d-bf09-026aa7acb78b",
													"intersection": {
														"id": "8b85c75f-1eaf-4b99-870a-c281f3bfaf4c",
														"name": "12th at Baker"
													},
													"ipAddress": "10.11.129.71",
													"name": "203060"
												},
												{
													"id": "1eb2a637-e9c6-442f-94ef-1d31775ba410",
													"intersection": {
														"id": "82d41f61-62ab-426d-96f0-2d224029ff2a",
														"name": "12th at Adams"
													},
													"ipAddress": "10.11.129.72",
													"name": "203059"
												},
												{
													"id": "c46adddd-df83-44db-af5c-ceeac097d0dc",
													"intersection": {
														"id": "0febad7b-2bd8-4dea-a52a-b59c9fef5393",
														"name": "OR213_82nd @ Boyer"
													},
													"ipAddress": "10.11.4.4",
													"name": "122091"
												},
												{
													"id": "7344b88e-fd70-4e35-8bed-11e2c063e1b0",
													"intersection": {
														"id": "1e5d23dd-f5f7-4bdf-ad86-784fbf69b5cd",
														"name": "OR224_Milwaukie Express @ Harrison"
													},
													"ipAddress": "10.11.4.185",
													"name": "122049"
												},
												{
													"id": "b55981e6-f521-4938-a86a-e19553067405",
													"intersection": {
														"id": "bdd97f88-54d3-48f9-92bb-8928d93f9476",
														"name": "OR8_Tualatin Valley @ Cornelius Pass"
													},
													"ipAddress": "10.11.5.85",
													"name": "122419"
												},
												{
													"id": "00b18927-6677-4817-9b2b-15afc339b374",
													"intersection": {
														"id": "6675a148-3716-443b-a507-c9a487aba4e7",
														"name": "OR8_Baseline @ 10th_E"
													},
													"ipAddress": "10.11.16.18",
													"name": "122533"
												},
												{
													"id": "0847323c-4712-4816-8d43-6cefe14dc675",
													"intersection": {
														"id": "4373264c-7ffb-4534-a65a-49b1b1aa387e",
														"name": "Pine @ Freeman"
													},
													"ipAddress": "10.12.38.70",
													"name": "308092"
												},
												{
													"id": "68c45a95-0aae-4fc3-8cfd-c63eb87b6537",
													"intersection": {
														"id": "d007a1d8-ab8d-4022-8fe9-d725cfb2de72",
														"name": "Pine @ I-5 SB"
													},
													"ipAddress": "10.12.38.69",
													"name": "8093"
												},
												{
													"id": "403f0ccd-ccc4-47f5-8ee9-b8a075099208",
													"intersection": {
														"id": "96420f07-11f6-4f23-8445-2e9a0ba655cd",
														"name": "Pine @ I-5 NB"
													},
													"ipAddress": "10.12.38.68",
													"name": "8094"
												},
												{
													"id": "8c51f1d6-bdd4-44c1-8ed4-bce7c5037bd2",
													"intersection": {
														"id": "162c76c0-bb66-4e8f-8024-fe383102ee5b",
														"name": "Pine St @ Peninger "
													},
													"ipAddress": "10.12.38.67",
													"name": "8095"
												},
												{
													"id": "6a517256-505c-4b78-9245-0b608e808681",
													"intersection": {
														"id": "3747c39f-9268-4031-8ba5-ceb3b79ae7f0",
														"name": "Pine @ Hamrick"
													},
													"ipAddress": "10.12.38.66",
													"name": "308096"
												},
												{
													"id": "15d95ec3-53d7-474a-9ab3-0b5dd799ca73",
													"intersection": {
														"id": "80d3cb81-e068-415b-82e4-952a841cd97d",
														"name": "OR22 at 25th"
													},
													"ipAddress": "10.11.135.134",
													"name": "203007"
												},
												{
													"id": "8ffe9680-9647-4254-841c-63374c1719bc",
													"intersection": {
														"id": "a5deddc5-2af8-4859-8a28-2fd29c8762cf",
														"name": "OR22 at 22nd"
													},
													"ipAddress": "10.11.135.135",
													"name": "203006"
												},
												{
													"id": "21aba9d5-5c95-4a2c-89d4-fc58eaec827f",
													"intersection": {
														"id": "e01c09e6-056d-4373-bd5c-99072babbbc1",
														"name": "OR22 at 17th"
													},
													"ipAddress": "10.11.135.136",
													"name": "203005"
												},
												{
													"id": "207c8cfb-d1e7-4c71-88d7-a319d675d558",
													"intersection": {
														"id": "9ca94469-c103-4aae-9dc2-79c83bb0f7aa",
														"name": "OR22 at Airport"
													},
													"ipAddress": "10.11.135.133",
													"name": "203008"
												},
												{
													"id": "369320a8-64b2-40c3-adaa-6afa50dbee94",
													"intersection": {
														"id": "1792a6f8-cf1d-426a-8c01-a541df775afb",
														"name": "OR22 at Hawthorne"
													},
													"ipAddress": "10.11.135.132",
													"name": "203009"
												},
												{
													"id": "0ffdb13a-d8e6-49c4-b133-c34c0a6d6f6e",
													"intersection": {
														"id": "51e0e213-8464-44f7-94df-e843ae7f7cb5",
														"name": "OR22 at I5 SB Ramp"
													},
													"ipAddress": "10.11.135.131",
													"name": "203010"
												},
												{
													"id": "2345b5ee-597a-465c-a45d-40215e677fb7",
													"intersection": {
														"id": "5b78d4de-e908-465d-b6da-af0d6c8c0bb5",
														"name": "OR22 at I5 NB Ramp"
													},
													"ipAddress": "10.11.135.130",
													"name": "203011"
												},
												{
													"id": "fcb2c30f-c058-475e-a872-a53e2cdf687f",
													"intersection": {
														"id": "e5573b10-2045-40b5-8263-56598a5a76e4",
														"name": "Spanish Hollow Temporary Bridge Construction"
													},
													"ipAddress": "10.12.101.202",
													"name": "181010"
												},
												{
													"id": "c450b1ce-3626-4386-8b25-1515e180d395",
													"intersection": {
														"id": "31d42460-fcc5-4de2-906b-e8ec56924f68",
														"name": "McKinney Slough Temp Bridge Signal"
													},
													"ipAddress": "10.11.200.10",
													"name": "29999"
												},
												{
													"id": "01a4bf91-0069-482d-84fe-680b1d904d89",
													"intersection": {
														"id": "f064e6b0-310e-48d8-a2ca-ac53f7a63376",
														"name": "Monmouth: OR99W at Main St"
													},
													"ipAddress": "1.1.1.1",
													"name": "203047"
												},
												{
													"id": "bba4f5f9-39b2-4d77-a802-795eeb8a9135",
													"intersection": {
														"id": "881b88ec-a40d-4db9-a896-5d5e386e1941",
														"name": "The very best controller ever!"
													},
													"ipAddress": "167.131.62.31",
													"name": "200001"
												},
												{
													"id": "4a4663f4-1783-49f9-b914-8190a3edef0e",
													"intersection": {
														"id": "525aed07-8f75-4f6a-b700-e1a99696028d",
														"name": "Godzilla "
													},
													"ipAddress": "167.131.144.81",
													"name": "1111"
												},
												{
													"id": "7931c4b5-868d-4c1b-8c9f-cdd4b23b9a71",
													"intersection": {
														"id": "f871492e-004d-4898-8fab-2c0175c90e3b",
														"name": "R2 Test Controller 23"
													},
													"ipAddress": "167.131.63.2",
													"name": "92323"
												},
												{
													"id": "9602fc31-03d6-4b6b-ab13-77590124f0e3",
													"intersection": {
														"id": "2b357877-3dd6-4898-8189-755a0095a7f7",
														"name": "Mothra"
													},
													"ipAddress": "167.131.144.80",
													"name": "1110"
												},
												{
													"id": "a42e1e83-97f3-47e6-8c6f-dfdfab3c7c4e",
													"intersection": {
														"id": "f7159f9d-2b53-444f-9a52-4f00fa9939a7",
														"name": "Ghidorah"
													},
													"ipAddress": "167.131.144.82",
													"name": "1112"
												},
												{
													"id": "a5876018-8313-4f1e-b893-d551614a1743",
													"intersection": {
														"id": "2fcc75a8-fa68-44c8-acab-3d12ccfc43f3",
														"name": "TSSU Test"
													},
													"ipAddress": "167.131.83.148",
													"name": "8148"
												},
												{
													"id": "5b723f12-92e7-4dc2-a613-d1d78d92769a",
													"intersection": {
														"id": "5c44e870-fde0-4738-b166-cd10a5d5141a",
														"name": "Rodan"
													},
													"ipAddress": "167.131.144.83",
													"name": "1113"
												},
												{
													"id": "f56b83c3-0786-4dbb-9038-c7b517fe2165",
													"intersection": {
														"id": "d5d32e06-f06f-411c-9c23-296e502a52ff",
														"name": "I-84EB_Ramp_at_238th"
													},
													"ipAddress": "10.11.5.100",
													"name": "122143"
												},
												{
													"id": "4ff03ebc-c9a8-4db5-b7d7-2a338a6ac7ce",
													"intersection": {
														"id": "a158332d-05a1-414e-86e7-e2ea0cf653ac",
														"name": "I-84WB_Ramp_at_238th"
													},
													"ipAddress": "10.11.5.99",
													"name": "122144"
												},
												{
													"id": "a1857c68-9c37-4dd0-a393-16e94325e38d",
													"intersection": {
														"id": "cdb84b90-c3fd-4e85-9610-d33925a77180",
														"name": "I-84EB_Ramp_at_207th"
													},
													"ipAddress": "10.11.5.98",
													"name": "122142"
												},
												{
													"id": "8a03c6a2-baa8-408c-9820-54249b937ffa",
													"intersection": {
														"id": "4d0f2349-5935-4522-90c9-32a847b2fffd",
														"name": "OR99E at Harrison"
													},
													"ipAddress": "10.11.5.42",
													"name": "122036"
												},
												{
													"id": "30c83d3e-8023-44db-a16f-f1455df7bd02",
													"intersection": {
														"id": "dd3df131-86b3-4b8b-82df-4559b0e94078",
														"name": "OR126 @ 27th"
													},
													"ipAddress": "10.12.64.85",
													"name": "410088"
												},
												{
													"id": "d5a7dfb0-dc11-4cc7-b41e-915a1618bf2c",
													"intersection": {
														"id": "5d4b984e-5fe6-413d-aa20-4f2f0b659849",
														"name": "Liberty at Commercial"
													},
													"ipAddress": "167.131.83.150",
													"name": "8150"
												},
												{
													"id": "84e2c3f1-b6a0-4494-8099-486eb08442f2",
													"intersection": {
														"id": "040f8674-a519-429a-aa33-77ba2f911103",
														"name": "TSSU Test Cabinet #4"
													},
													"ipAddress": "167.131.83.130",
													"name": "8130"
												},
												{
													"id": "71d4f21f-3a3d-47da-961e-e20b38362796",
													"intersection": {
														"id": "97194c98-27ac-4d4e-8637-eb67d1cc7378",
														"name": "Dereks Unimaginative Controller"
													},
													"ipAddress": "167.131.63.1",
													"name": "17"
												},
												{
													"id": "bbfaf11e-c7a7-43b1-bbf3-91d875870164",
													"intersection": {
														"id": "3acdd022-0e01-4427-b58c-e64696c4ccef",
														"name": "Mr. Ping"
													},
													"ipAddress": "167.131.148.1",
													"name": "4"
												},
												{
													"id": "e4b24f33-a596-4f6a-8fb5-8a879a5e0c39",
													"intersection": {
														"id": "da14068e-166a-4394-8124-e64c5e665c0f",
														"name": "Mt. Emily"
													},
													"ipAddress": "167.131.224.21",
													"name": "50001"
												},
												{
													"id": "d72131c5-2e80-421b-847d-a71b7ee712ef",
													"intersection": {
														"id": "38b75d28-0063-4a3a-9f43-03484b67e362",
														"name": "King Kong"
													},
													"ipAddress": "167.131.144.84",
													"name": "1114"
												},
												{
													"id": "35fc8897-a475-4de2-950a-cd686e453a52",
													"intersection": {
														"id": "99bfdf2d-dfba-4150-b0d8-b19898293374",
														"name": "Mt. Harris"
													},
													"ipAddress": "167.131.224.27",
													"name": "50002"
												},
												{
													"id": "bfeaab18-6d97-4fce-bcc6-acf8e1b3c524",
													"intersection": {
														"id": "0d57a106-5a1d-4c2a-b73f-b56f583c03ed",
														"name": "The Dalek"
													},
													"ipAddress": "167.131.144.89",
													"name": "5"
												},
												{
													"id": "d24daaec-6da1-4735-a06b-4e2fa887f047",
													"intersection": {
														"id": "3733e141-f1b8-4028-9c03-5b5275564514",
														"name": "The Master"
													},
													"ipAddress": "167.131.144.88",
													"name": "2"
												},
												{
													"id": "17ea3d83-0503-4cf4-84ba-06796c531157",
													"intersection": {
														"id": "499a1452-a536-4658-9969-b880003f3e41",
														"name": "TSSU Test Cabinet # 3"
													},
													"ipAddress": "167.131.83.143",
													"name": "8143d"
												},
												{
													"id": "02ae7a09-71a6-409b-8c3b-509622818386",
													"intersection": {
														"id": "aaa9bbe6-ac3e-46df-8bb2-ba85e6db63b9",
														"name": "Test Simulated Controller"
													},
													"ipAddress": "maxtime-0",
													"name": "1"
												},
												{
													"id": "d45daa0a-6506-4bf5-9fd9-900d643d541f",
													"intersection": {
														"id": "3de70073-3a1a-4040-97f3-bd4a89afc2e3",
														"name": "emulator test"
													},
													"ipAddress": "167.131.145.58",
													"name": "emulator"
												},
												{
													"id": "590a3e9c-86f5-47f7-b915-9af5f5c2424e",
													"intersection": {
														"id": "88cce948-40e6-4511-8725-9b0b2e670fa1",
														"name": "Vitae Springs Rd S at NFD Road 77"
													},
													"ipAddress": "10.9.144.2",
													"name": "03999"
												},
												{
													"id": "4350579f-6149-49e2-adc6-43cd432f8825",
													"intersection": {
														"id": "c2fef7cf-6667-46c8-bb9b-542d8cb62cf5",
														"name": "testing"
													},
													"ipAddress": "167.131.144.85",
													"name": "test device"
												},
												{
													"id": "c6fa38d4-fadc-4ac4-9d74-1265a19f58f7",
													"intersection": {
														"id": "182aed2a-aa36-4a81-8196-eb7f8c92b41f",
														"name": "Brian Test Controller #2"
													},
													"ipAddress": "10.11.5.70",
													"name": "Brian Test Controller #2"
												},
												{
													"id": "3675d9a3-cbc8-4f29-91c9-308d11bf00f2",
													"intersection": {
														"id": "96d948a6-2c61-405b-bfee-bede6960fdc1",
														"name": "R5 - Emily"
													},
													"ipAddress": "167.131.224.21",
													"name": "R5 test"
												},
												{
													"id": "6f3964d8-bbee-4a5e-883c-a143eb8195c9",
													"intersection": {
														"id": "97932610-f81a-4392-8dfb-4b1663ec6bd2",
														"name": "The Doctor"
													},
													"ipAddress": "167.131.144.85",
													"name": "1"
												}
											]
										}
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "data",
										"type": "StructType(StructField(devices,ArrayType(StructType(StructField(id,StringType,true),StructField(intersection,StructType(StructField(id,StringType,true),StructField(name,StringType,true)),true),StructField(ipAddress,StringType,true),StructField(name,StringType,true)),true),true))"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "count",
									"categoryFieldKeys": [],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					}
				}
			},
			"enableDebugMode": false,
			"language_info": {
				"name": "python"
			},
			"a365ComputeOptions": {
				"id": "/subscriptions/499bc654-f84c-46c2-952c-b30be508f78c/resourceGroups/SynapseFromScratch-Demo/providers/Microsoft.Synapse/workspaces/synapsefromscratch/bigDataPools/SparkPool13",
				"name": "SparkPool13",
				"type": "Spark",
				"endpoint": "https://synapsefromscratch.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool13",
				"auth": {
					"type": "AAD",
					"authResource": "https://dev.azuresynapse.net",
					"authHeader": null
				},
				"sparkVersion": "3.3",
				"nodeCount": 10,
				"cores": 4,
				"memory": 28,
				"extraHeader": null
			},
			"sessionKeepAliveTimeout": 30
		},
		"cells": [
			{
				"cell_type": "code",
				"metadata": {
					"microsoft": {
						"language": "python"
					},
					"collapsed": false
				},
				"source": [
					"%%pyspark\r\n",
					"df = spark.read.load('abfss://dlsynapsefromscratchfs@dlsynapsefromscratchacct.dfs.core.windows.net/OR-DOT/Odot_Sample.json', format='json')\r\n",
					"display(df.limit(10))\r\n",
					"\r\n",
					""
				],
				"execution_count": 111
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"df_json = df.toJSON()\r\n",
					"print(type(df_json))\r\n",
					""
				],
				"execution_count": 112
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"df2 = df.withColumn(\"name\")\r\n",
					"print(type(df2))\r\n",
					"print(df2[0:6])"
				],
				"execution_count": 70
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# from pyspark.sql import SparkSession\r\n",
					"from pyspark.sql.functions import from_json\r\n",
					"from pyspark.sql.types import MapType, StringType\r\n",
					"\r\n",
					"# Initialize SparkSession\r\n",
					"# spark = SparkSession.builder.appName('example').getOrCreate()\r\n",
					"\r\n",
					"# Suppose you have a DataFrame with a JSON string\r\n",
					"jsonString = \"{\\\"Zipcode\\\":704,\\\"ZipCodeType\\\":\\\"STANDARD\\\",\\\"City\\\":\\\"PARC PARQUE\\\",\\\"State\\\":\\\"PR\\\"}\"\r\n",
					"# jsonString = df_json\r\n",
					"df = spark.createDataFrame([(1, jsonString)], [\"id\", \"value\"])\r\n",
					"\r\n",
					"# Convert JSON string column to Map type\r\n",
					"df2 = df.withColumn(\"value\", from_json(df.value, MapType(StringType(), StringType())))\r\n",
					"\r\n",
					"# Show the DataFrame\r\n",
					"df2.show(truncate=False)"
				],
				"execution_count": 102
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"from pyspark.sql.functions import from_json\r\n",
					"from pyspark.sql.types import MapType, StringType\r\n",
					"\r\n",
					"# Convert JSON string column to Map type\r\n",
					"df2 = df.withColumn(\"name\", from_json(df.name, MapType(StringType(), StringType())))\r\n",
					"\r\n",
					"# Show the DataFrame\r\n",
					"df2.show(truncate=False)\r\n",
					""
				],
				"execution_count": 67
			}
		]
	}
}